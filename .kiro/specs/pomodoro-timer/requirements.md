# Requirements Document

## Introduction
Tonariアプリケーションにポモドーロタイマー機能を追加する。ユーザーは作業時間と休憩時間を交互に繰り返すタイマーを利用し、集中作業を支援する。タイマーUIは画面右上に半透過の円形プログレスとして表示され、VRMアバターとの共存を実現する。作業中はアバターの睡眠モードを抑制し、作業専用モーションを再生する。

## Requirements

### Requirement 1: タイマー基本機能
**Objective:** ユーザーとして、作業時間と休憩時間を交互に繰り返すタイマーを使いたい。集中と休息のリズムを作ることで生産性を向上させたい。

#### Acceptance Criteria
1. When ユーザーがタイマーを開始する, the ポモドーロタイマー shall 作業セッションのカウントダウンを開始する
2. When 作業セッションが終了する, the ポモドーロタイマー shall 自動的に休憩セッションに切り替える
3. When 休憩セッションが終了する, the ポモドーロタイマー shall 自動的に次の作業セッションに切り替える
4. The ポモドーロタイマー shall デフォルトで作業時間25分、休憩時間5分を設定する
5. The ポモドーロタイマー shall タイマーの残り時間を1秒単位で正確にカウントダウンする

### Requirement 2: タイマー操作
**Objective:** ユーザーとして、タイマーを一時停止・再開・スキップ・停止したい。予期しない中断にも柔軟に対応したい。

#### Acceptance Criteria
1. When ユーザーが一時停止ボタンを押す, the ポモドーロタイマー shall カウントダウンを停止し、現在の残り時間を保持する
2. When ユーザーが再開ボタンを押す, the ポモドーロタイマー shall 停止した残り時間からカウントダウンを再開する
3. When ユーザーがスキップボタンを押す, the ポモドーロタイマー shall 現在のセッションを終了し、次のセッション（作業→休憩 or 休憩→作業）に移行する
4. When ユーザーが停止ボタンを押す, the ポモドーロタイマー shall タイマーを完全に終了し、通常モードに戻る

### Requirement 3: 自動開始
**Objective:** ユーザーとして、セッション切り替え時にタイマーが自動で開始されるか手動で開始するかを選択したい。自分のペースに合わせたワークフローを実現したい。

#### Acceptance Criteria
1. When 自動開始が有効で、セッションが切り替わる, the ポモドーロタイマー shall 次のセッションを自動的に開始する
2. When 自動開始が無効で、セッションが切り替わる, the ポモドーロタイマー shall 次のセッションを開始せず、ユーザーの手動操作を待つ
3. The ポモドーロタイマー shall デフォルトで自動開始を有効にする

### Requirement 4: セッションカウント表示
**Objective:** ユーザーとして、完了したポモドーロ数と設定した目標セッション数に対する進捗を確認したい。達成感を得ることでモチベーションを維持したい。

#### Acceptance Criteria
1. The ポモドーロタイマー shall 完了した作業セッション数と目標セッション数を表示する
2. The ポモドーロタイマー shall 目標セッション数に対する進捗を視覚的に表示する（例: ● ● ○ ○ のような表現）
3. When 設定した目標セッション数を達成する, the ポモドーロタイマー shall タイマーを完了状態にする
4. When タイマーが停止される, the ポモドーロタイマー shall セッションカウントをリセットする

### Requirement 5: 設定とローカルストレージ保存
**Objective:** ユーザーとして、タイマーの各時間やセッション数を設定し、次回起動時にも同じ設定を使いたい。毎回設定し直す手間を省きたい。

#### Acceptance Criteria
1. The ポモドーロタイマー shall 作業時間、休憩時間をそれぞれ分単位で設定可能にする
2. The ポモドーロタイマー shall 目標セッション回数を設定可能にする
3. The ポモドーロタイマー shall 自動開始のオン/オフを設定可能にする
4. When 設定が変更される, the ポモドーロタイマー shall 変更内容をローカルストレージに即座に保存する
5. When アプリケーションが起動する, the ポモドーロタイマー shall ローカルストレージから保存済みの設定を読み込む
6. If ローカルストレージに設定が存在しない, the ポモドーロタイマー shall デフォルト値（作業25分、休憩5分、4セッション、自動開始ON）を使用する

### Requirement 6: 円形タイマーUI
**Objective:** ユーザーとして、タイマーの進行状況を円形プログレスで直感的に確認したい。残り時間を数字でも確認したい。

#### Acceptance Criteria
1. The ポモドーロタイマー shall 円形のプログレスインジケーターでタイマー進行状況を表示する
2. The ポモドーロタイマー shall 円を360度として設定分数で分割し、経過に応じて円が埋まっていくアニメーションを表示する
3. The ポモドーロタイマー shall 円の中心に残り時間を「分:秒」形式のデジタル表示で表示する
4. The ポモドーロタイマー shall 作業セッションと休憩セッションを視覚的に区別できる色分けをする
5. The ポモドーロタイマー shall UIの大部分を半透過にし、背後のVRMアバターが見えるようにする

### Requirement 7: メニュー統合と表示位置
**Objective:** ユーザーとして、既存のメニューからポモドーロタイマーを起動したい。タイマーUIはアバターの邪魔にならない位置に表示したい。

#### Acceptance Criteria
1. The ポモドーロタイマー shall メニューバーにタイマー起動アイコンを追加する
2. When ユーザーがメニューのタイマーアイコンをクリックする, the ポモドーロタイマー shall 画面右上にタイマーUIを表示する
3. When タイマーが停止される, the ポモドーロタイマー shall タイマーUIを非表示にする
4. The ポモドーロタイマー shall タイマーUIをVRMアバターの上にオーバーレイ表示する
5. The ポモドーロタイマー shall タイマーUIを独立したコンポーネントとして実装し、表示位置の変更が容易にできるようにする

### Requirement 8: 睡眠モード連携
**Objective:** ユーザーとして、作業中にアバターが睡眠モードに入らないようにしたい。アバターが起きている状態で集中作業を続けたい。

#### Acceptance Criteria
1. While ポモドーロタイマーの作業セッションが実行中, the 睡眠モード shall 睡眠チェックをスキップし、アバターを起きた状態に保つ
2. While ポモドーロタイマーの休憩セッションが実行中, the 睡眠モード shall 通常通り睡眠チェックを行う
3. When ポモドーロタイマーが停止される, the 睡眠モード shall 通常の睡眠チェックサイクルに復帰する

### Requirement 9: 作業中モーション
**Objective:** ユーザーとして、作業中のアバターが待機時と異なる専用モーションを再生してほしい。アバターが一緒に作業している雰囲気を感じたい。

#### Acceptance Criteria
1. While ポモドーロタイマーの作業セッションが実行中, the VRMアバター shall 通常の待機モーションではなく、作業専用モーションセットからランダムにモーションを再生する
2. When ポモドーロタイマーが停止または休憩セッションに切り替わる, the VRMアバター shall 通常の待機モーションに戻る
3. The VRMアバター shall 作業専用モーションとして複数のVRMAアニメーション（例: ガッツポーズ、読書など）をサポートする
